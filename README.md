# scriv2tex
*scriv2tex* is a script that automates the workflow from Scrivener document to TeX document. It is not based on the Scrivener compile, but on the sync function. The resulting TeX document is not one big TeX file, but consists of the same documents found in the Scrivener Drafts folder. The first text file in the Draft folder is treated as preamble file and the required document tags with \\*includes* is generated by the script. This allows the use of \\*includeonly* for partial compilation.

## Getting started

### Prerequisites
- OSX (currently Catalina 10.15.7)
- Scrivener 3 (currently 3.2.2)
- Python 3 (currently 3.7.0)

## Installation

The *scriv2tex* script is run in a terminal and therefore needs to be added your PATH environment variable.

## Usage
### Project initialisation
1. Create a directory for syncing your project with file extension ".sync".
2. In Scrivener choose **File->Sync->with External Folder...**
3. Choose the external folder created in step 1.
4. Select the following options:
- [x] Sync the contents of the Draft folder
- [ ] Sync all other text documents in the project
- [ ] Sync only documents in collection:
- [x] Prefix file names with numbers
- [ ] Take snapshots of affected documents before updating
- [x] Check external folder on project open and automatically sync on close
5. Select the format "Plain Text" with extension "tex".
6. Confirm the selections by pressing the "Sync" button.
7. Open a terminal and change to the parent directory of the ".sync" folder where the Scrivener project was synced with. Then start the blocking *scriv2tex* script:
```bash
scriv2tex
```
8. the *scriv2tex* script is now monitoring all ".scriv" directories under the directory where it was executed.

### Project usage
Next to the directory created for syncing your project a new directory has been created with file extension ".tex". This is where the *scriv2tex* script syncs the TeX documents. Here you can also store external content required by your TeX documents, like style sheets, pictures, etc.
The *scriv2tex* script also looks here for a script called "compile.sh", which will, if present, be executed after every sync of your project (**File->Sync->with External Folder Now**). For an example of compile script, see the example project folder "The Legrand Orange Book.tex".

### Tip
Since you'll now will be choosing **File->Sync->with External Folder Now** frequntly, it's worthwhile to create a keyboard shorcut. Fortunately this is easy on a Mac:
1. Head to your Mac’s System Preferences (you can find it by hitting the Apple logo at top-left, then clicking “System Preferences”)
2. Click Keyboard
3. Click the Shortcuts tab, then click App Shortcuts – the bottom option in the left pane.
4. Click the “+” button to create your keyboard shortcut.
5. Pick "Scrivener" and type the exact name of the menu item in the "Menu Title" field, e.g. "with External Folder Now"
6. Finally, you need to pick your keyboard shortcut. Make sure the key combination you want isn’t already taken by opening your program and testing it out. If something happens, that shortcut is already assigned – if nothing happens and you hear a warning sound, the shortcut is available. I chose ⇧⌘S.
7. Click Add when you’ve got everything set the way you want it. The change will take affect immediately.

## Contributing
Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.

Please make sure to update tests as appropriate.

## License
[![License: CC BY-NC-SA 4.0](https://img.shields.io/badge/License-CC%20BY--NC--SA%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by-nc-sa/4.0/)
